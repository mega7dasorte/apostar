<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorteio Fictício</title>
<style>
  body { font-family: sans-serif; background: #fff3c4; color: #333; margin: 0; padding: 0; }
  header { padding: 1rem; background: #facc15; display: flex; justify-content: space-between; align-items: center; }
  h1 { margin: 0; }
  button { cursor: pointer; }
  .grid { display: grid; gap: 5px; margin-top: 1rem; }
  .grid-cols-10 { grid-template-columns: repeat(10, 1fr); }
  .numero { width: 35px; height: 35px; border-radius: 50%; border: 1px solid #333; display:flex; align-items:center; justify-content:center; }
  .selecionado { background: #dc2626; color: white; }
</style>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
</head>
<body>
<header>
  <h1>Sorteio Fictício</h1>
</header>

<main style="padding:1rem; max-width:600px; margin:auto;">
  <section>
    <label>Quantidade de números:
      <select id="qtdNumeros">
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
      </select>
    </label>
    <label>Quantidade de apostas:
      <input type="number" id="qtdApostas" value="1" min="1" max="1000">
    </label>
    <button id="confirmar">Confirmar Aposta</button>
  </section>

  <section class="grid grid-cols-10" id="numerosGrid"></section>

  <p>Selecionados: <span id="selecionados"></span></p>
</main>

<script>
  // ===================== SUPABASE =====================
  const supabaseUrl = 'https://rfvkadlbnztnbfwabhzj.supabase.co';
  const supabaseAnonKey = 'COLOQUE_SUA_ANON_KEY_AQUI'; // ⚠️ Substitua pela sua anon key
  const supabase = supabase.createClient(supabaseUrl, supabaseAnonKey);

  // ===================== LÓGICA =====================
  const qtdNumerosEl = document.getElementById('qtdNumeros');
  const qtdApostasEl = document.getElementById('qtdApostas');
  const numerosGridEl = document.getElementById('numerosGrid');
  const selecionadosEl = document.getElementById('selecionados');
  const confirmarBtn = document.getElementById('confirmar');

  let selecionados = [];

  function renderGrid() {
    numerosGridEl.innerHTML = '';
    for (let i=1; i<=70; i++){
      const btn = document.createElement('div');
      btn.textContent = i;
      btn.className = 'numero' + (selecionados.includes(i) ? ' selecionado' : '');
      btn.onclick = () => toggleNumero(i);
      numerosGridEl.appendChild(btn);
    }
    selecionadosEl.textContent = selecionados.join(', ');
  }

  function toggleNumero(n) {
    const max = parseInt(qtdNumerosEl.value);
    if (selecionados.includes(n)) {
      selecionados = selecionados.filter(x => x!==n);
    } else if (selecionados.length < max) {
      selecionados.push(n);
    }
    renderGrid();
  }

  confirmarBtn.onclick = async () => {
    const qtdNumeros = parseInt(qtdNumerosEl.value);
    const qtdApostas = parseInt(qtdApostasEl.value);
    if (selecionados.length !== qtdNumeros) {
      alert(`Escolha exatamente ${qtdNumeros} números`);
      return;
    }

    // Envio para Supabase (tabela fictícia: apostas)
    const { data, error } = await supabase
      .from('apostas')
      .insert([{ numeros: selecionados, qtdApostas, criado_em: new Date() }]);

    if (error) {
      alert('Erro ao registrar aposta: ' + error.message);
    } else {
      alert('Aposta registrada com sucesso (ficção)');
      selecionados = [];
      renderGrid();
    }
  };

  renderGrid();
</script>
</body>
</html>
