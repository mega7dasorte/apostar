<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Sorteio da Sorte - PrÃªmio de R$500.000</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>ðŸ’° Sorteio da Sorte</h1>
    <p>Escolha 7 nÃºmeros e concorra a <strong>R$ 500.000,00</strong></p>
    <div class="seguranca">
      ðŸ”’ Site Seguro | âœ… ConexÃ£o Protegida |
      <a href="https://www.caixa.gov.br" target="_blank">Caixa EconÃ´mica Federal</a>
    </div>
  </header>

  <main>
    <section class="aposta">
      <h2>Escolha seus 7 nÃºmeros</h2>
      <div id="numeros"></div>
      <button onclick="enviarAposta()">Enviar aposta (R$20)</button>
    </section>

    <section class="mensagens">
      <h2>ðŸš€ Ãšltimos ganhadores</h2>
      <ul id="mensagens"></ul>
    </section>

    <section class="depoimentos">
      <h2>ðŸ“¢ Depoimentos</h2>
      <ul id="depoimentos"></ul>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Sorteio da Sorte - Todos os direitos reservados</p>
  </footer>

  <script>
    let escolhidos = [];

    // Renderiza os botÃµes 1 a 70
    const container = document.getElementById("numeros");
    for (let i = 1; i <= 70; i++) {
      let btn = document.createElement("button");
      btn.textContent = i;
      btn.onclick = () => escolherNumero(i, btn);
      container.appendChild(btn);
    }

    function escolherNumero(num, btn) {
      if (escolhidos.includes(num)) {
        escolhidos = escolhidos.filter(n => n !== num);
        btn.classList.remove("selecionado");
      } else if (escolhidos.length < 7) {
        escolhidos.push(num);
        btn.classList.add("selecionado");
      }
    }

    async function enviarAposta() {
      const nome = "UsuÃ¡rio AnÃ´nimo";
      const valor = 20;

      let res = await fetch("http://localhost:4000/aposta", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ nome, numeros: escolhidos, valor })
      });
      let data = await res.json();
      alert("Aposta registrada! Boa sorte!");
    }

    // Carrega mensagens e depoimentos
    async function carregar() {
      let msgRes = await fetch("http://localhost:4000/mensagens");
      let msgs = await msgRes.json();
      document.getElementById("mensagens").innerHTML =
        msgs.map(m => `<li>${m.texto}</li>`).join("");

      let depRes = await fetch("http://localhost:4000/depoimentos");
      let deps = await depRes.json();
      document.getElementById("depoimentos").innerHTML =
        deps.map(d => `<li>"${d.texto}" - ${d.nome}</li>`).join("");
    }
    carregar();
  </script>
</body>
</html>
